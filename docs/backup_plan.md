# ç³»çµ±è³‡æ–™å‚™ä»½èˆ‡å¾©åŸåŠŸèƒ½ å¯¦ä½œè¨ˆç•«

> æ–‡ä»¶ç‰ˆæœ¬: 1.1  
> æœ€å¾Œæ›´æ–°: 2026-01-12

---

## 1. åŠŸèƒ½æ¦‚è¿°

### 1.1 ç›®æ¨™

åœ¨ã€Œä½¿ç”¨è€…ç®¡ç†ã€é é¢ (`/admin/users`) æ–°å¢**ç³»çµ±è³‡æ–™å‚™ä»½èˆ‡å¾©åŸ**åŠŸèƒ½ï¼Œè®“ Admin ä½¿ç”¨è€…èƒ½å¤ ï¼š

1. **å‚™ä»½**ï¼šå°‡è³‡æ–™åº«ã€ä¸Šå‚³æª”æ¡ˆã€ISO æ–‡ä»¶**åˆ†åˆ¥**æ‰“åŒ…æˆç¨ç«‹å£“ç¸®æª”ï¼Œé¿å…å–®ä¸€æª”æ¡ˆéå¤§
2. **å¾©åŸ**ï¼šä¸Šå‚³å‚™ä»½æª”æ¡ˆï¼ˆå¯é¸æ“‡æ€§é‚„åŸï¼‰ï¼Œé‚„åŸè³‡æ–™åº«èˆ‡æª”æ¡ˆç³»çµ±
3. **å¼·åˆ¶ç™»å‡º**ï¼šå¾©åŸå®Œæˆå¾Œå¼·åˆ¶ç™»å‡ºæ‰€æœ‰ä½¿ç”¨è€…ï¼Œç¢ºä¿è³‡æ–™ä¸€è‡´æ€§

### 1.2 ä½¿ç”¨æƒ…å¢ƒ

- **ç’°å¢ƒé·ç§»**ï¼šå°‡ç³»çµ±å¾ä¸€å°é›»è…¦ï¼ˆæˆ–ä¼ºæœå™¨ï¼‰å®Œæ•´æ¬ç§»åˆ°å¦ä¸€å°
- **ç½é›£å¾©åŸ**ï¼šç•¶ç³»çµ±ç™¼ç”Ÿæ•…éšœæ™‚ï¼Œå¿«é€Ÿé‚„åŸè‡³å‚™ä»½ç‹€æ…‹
- **é–‹ç™¼/æ¸¬è©¦**ï¼šè¤‡è£½æ­£å¼ç’°å¢ƒè³‡æ–™è‡³æ¸¬è©¦ç’°å¢ƒ

### 1.3 æ¬Šé™è¦æ±‚

| åŠŸèƒ½ | æ‰€éœ€è§’è‰² |
|------|----------|
| å‚™ä»½è³‡æ–™ | ADMIN |
| å¾©åŸè³‡æ–™ | ADMIN |

---

## 2. æŠ€è¡“æ¶æ§‹

### 2.1 å‚™ä»½å…§å®¹

| é¡åˆ¥ | ä¾†æº | æª”æ¡ˆæ ¼å¼ |
|------|------|----------|
| è³‡æ–™åº« | PostgreSQL (æ‰€æœ‰ Tables) | SQL dump |
| ä¸Šå‚³æª”æ¡ˆ | `/public/uploads/` | åŸå§‹æª”æ¡ˆ |
| ISO æ–‡ä»¶ | `/public/iso_doc/` | åŸå§‹æª”æ¡ˆ |
| ä½¿ç”¨è€…ç°½å | `/public/uploads/signatures/` | åŸå§‹æª”æ¡ˆ |
| ç³»çµ±é…ç½® | `.env` (å¯é¸ï¼Œéœ€ä½¿ç”¨è€…å‹¾é¸) | æ–‡å­—æª” |

### 2.2 å‚™ä»½æª”æ¡ˆçµæ§‹ï¼ˆåˆ†é›¢å¼ï¼‰

ç‚ºé¿å…å–®ä¸€å£“ç¸®æª”éå¤§ï¼Œå‚™ä»½å°‡ç”¢ç”Ÿ**å¤šå€‹ç¨ç«‹ ZIP æª”æ¡ˆ**ï¼š

```
RMS_Backup_20260112_133250/
â”œâ”€â”€ RMS_Database_20260112_133250.zip     # è³‡æ–™åº«å‚™ä»½
â”‚   â”œâ”€â”€ rms_db.sql
â”‚   â””â”€â”€ manifest.json
â”œâ”€â”€ RMS_Uploads_20260112_133250.zip      # ä¸Šå‚³æª”æ¡ˆå‚™ä»½
â”‚   â”œâ”€â”€ uploads/
â”‚   â”‚   â”œâ”€â”€ 2025/
â”‚   â”‚   â”œâ”€â”€ 2026/
â”‚   â”‚   â””â”€â”€ signatures/
â”‚   â””â”€â”€ manifest.json
â””â”€â”€ RMS_IsoDocs_20260112_133250.zip      # ISO æ–‡ä»¶å‚™ä»½
    â”œâ”€â”€ iso_doc/
    â”‚   â””â”€â”€ *.pdf
    â””â”€â”€ manifest.json
```

**å„ªé»**ï¼š

- å¯é¸æ“‡æ€§ä¸‹è¼‰/é‚„åŸç‰¹å®šé¡åˆ¥
- é¿å…ç€è¦½å™¨ä¸‹è¼‰è¶…å¤§æª”æ¡ˆå¤±æ•—
- ä¾¿æ–¼åˆ†é–‹å‚³è¼¸èˆ‡ç®¡ç†

### 2.3 manifest.json çµæ§‹

æ¯å€‹ ZIP æª”æ¡ˆå…§éƒ½åŒ…å«ç¨ç«‹çš„ `manifest.json`ï¼š

```json
{
  "version": "1.1",
  "createdAt": "2026-01-12T13:32:50+08:00",
  "systemVersion": "1.6.0",
  "backupType": "database",
  "databaseType": "postgresql",
  "stats": {
    "tableCount": 16,
    "userCount": 5,
    "projectCount": 3,
    "itemCount": 120
  }
}
```

---

## 3. å¯¦ä½œè¨ˆç•«

### 3.1 å¾Œç«¯ API

#### 3.1.1 å‚™ä»½ APIï¼ˆåˆ†é›¢å¼ï¼‰

**Endpoints**:

| API | ç”¨é€” | è¼¸å‡ºæª”æ¡ˆ |
|-----|------|----------|
| `POST /api/admin/backup/database` | å‚™ä»½è³‡æ–™åº« | `RMS_Database_*.zip` |
| `POST /api/admin/backup/uploads` | å‚™ä»½ä¸Šå‚³æª”æ¡ˆ | `RMS_Uploads_*.zip` |
| `POST /api/admin/backup/iso-docs` | å‚™ä»½ ISO æ–‡ä»¶ | `RMS_IsoDocs_*.zip` |

**åŠŸèƒ½**:

1. é©—è­‰ Admin æ¬Šé™
2. æ ¹æ“šé¡å‹åŸ·è¡Œå°æ‡‰å‚™ä»½é‚è¼¯
3. å»ºç«‹è©²é¡åˆ¥çš„ `manifest.json`
4. ä½¿ç”¨ `archiver` å£“ç¸®æˆ ZIP
5. å›å‚³å£“ç¸®æª”ä¸‹è¼‰ä¸²æµ

**æŠ€è¡“é¸å‹**:

| å¥—ä»¶ | ç”¨é€” |
|------|------|
| `archiver` | Node.js ZIP å£“ç¸® (ä¸²æµå¼ï¼Œè¨˜æ†¶é«”æ•ˆç‡é«˜) |
| `pg` / `prisma` | è³‡æ–™åº«åŒ¯å‡º |
| `fs-extra` | æª”æ¡ˆæ“ä½œ |

**ç¨‹å¼ç¢¼ä½ç½®**: `src/app/api/admin/backup/route.ts`

```typescript
// è™›æ“¬ç¢¼ç¤ºæ„
export async function POST(request: Request) {
  // 1. æ¬Šé™é©—è­‰
  const session = await getServerSession(authOptions);
  if (!session || session.user.role !== 'ADMIN') {
    return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
  }

  // 2. å»ºç«‹å‚™ä»½
  const timestamp = format(new Date(), 'yyyyMMdd_HHmmss');
  const backupName = `RMS_Backup_${timestamp}`;
  
  // 3. åŒ¯å‡ºè³‡æ–™åº« (ä½¿ç”¨ Prisma è®€å–æ‰€æœ‰è³‡æ–™ä¸¦åºåˆ—åŒ–ç‚º SQL)
  const sqlDump = await exportDatabaseToSQL();
  
  // 4. å»ºç«‹ ZIP ä¸²æµ
  const archive = archiver('zip', { zlib: { level: 9 } });
  
  // 5. åŠ å…¥æª”æ¡ˆ
  archive.append(sqlDump, { name: 'database/rms_db.sql' });
  archive.directory('public/uploads/', 'uploads');
  archive.directory('public/iso_doc/', 'iso_doc');
  archive.append(JSON.stringify(manifest), { name: 'manifest.json' });
  
  // 6. å›å‚³ä¸‹è¼‰
  return new Response(archive, {
    headers: {
      'Content-Type': 'application/zip',
      'Content-Disposition': `attachment; filename="${backupName}.zip"`
    }
  });
}
```

#### 3.1.2 å¾©åŸ APIï¼ˆåˆ†é›¢å¼ï¼‰

**Endpoints**:

| API | ç”¨é€” |
|-----|------|
| `POST /api/admin/restore/database` | å¾©åŸè³‡æ–™åº« |
| `POST /api/admin/restore/uploads` | å¾©åŸä¸Šå‚³æª”æ¡ˆ |
| `POST /api/admin/restore/iso-docs` | å¾©åŸ ISO æ–‡ä»¶ |

**åŠŸèƒ½**:

1. é©—è­‰ Admin æ¬Šé™
2. æ¥æ”¶ä¸Šå‚³çš„ ZIP æª”æ¡ˆ
3. è§£å£“ç¸®è‡³æš«å­˜ç›®éŒ„
4. é©—è­‰ `manifest.json` çµæ§‹èˆ‡ `backupType`
5. æ ¹æ“šé¡å‹åŸ·è¡Œå°æ‡‰é‚„åŸé‚è¼¯
6. **å¾©åŸè³‡æ–™åº«å¾Œå¼·åˆ¶ç™»å‡ºæ‰€æœ‰ä½¿ç”¨è€…**ï¼ˆæ¸…é™¤ Sessionï¼‰
7. æ¸…ç†æš«å­˜æª”æ¡ˆ

**ç¨‹å¼ç¢¼ä½ç½®**: `src/app/api/admin/restore/[type]/route.ts`

**å®‰å…¨è€ƒé‡**:

- **ä¸é™åˆ¶**ä¸Šå‚³æª”æ¡ˆå¤§å°ï¼ˆä¾ç³»çµ±è³‡æºè‡ªå‹•è™•ç†ï¼‰
- é©—è­‰ ZIP æª”æ¡ˆçµæ§‹
- ä½¿ç”¨äº¤æ˜“ (Transaction) ç¢ºä¿è³‡æ–™åº«å®Œæ•´æ€§
- å¾©åŸå‰è‡ªå‹•å»ºç«‹ç•¶å‰ç‹€æ…‹å‚™ä»½ (Failsafe)
- å¾©åŸå®Œæˆå¾Œ**å¼·åˆ¶ç™»å‡ºæ‰€æœ‰ä½¿ç”¨è€…**

---

### 3.2 å‰ç«¯ UI

#### 3.2.1 å…ƒä»¶è¨­è¨ˆ

**ä½ç½®**: `/admin/users` é é¢åº•éƒ¨æ–°å¢ã€Œç³»çµ±å‚™ä»½èˆ‡å¾©åŸã€å€å¡Š

**UI ä½ˆå±€ï¼ˆåˆ†é›¢å¼ï¼‰**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“¦ ç³»çµ±å‚™ä»½èˆ‡å¾©åŸ                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  ğŸ”½ è³‡æ–™å‚™ä»½ï¼ˆåˆ†åˆ¥ä¸‹è¼‰ï¼‰                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸ—„ï¸ è³‡æ–™åº« (PostgreSQL)    [ğŸ“¥ ä¸‹è¼‰]               â”‚   â”‚
â”‚  â”‚  ğŸ“ ä¸Šå‚³æª”æ¡ˆ (/uploads/)   [ğŸ“¥ ä¸‹è¼‰]               â”‚   â”‚
â”‚  â”‚  ğŸ“„ ISO æ–‡ä»¶ (/iso_doc/)   [ğŸ“¥ ä¸‹è¼‰]               â”‚   â”‚
â”‚  â”‚                                                    â”‚   â”‚
â”‚  â”‚  [ï¿½ å…¨éƒ¨ä¸‹è¼‰] (ä¾åºä¸‹è¼‰ä¸‰å€‹æª”æ¡ˆ)                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”‚  ğŸ”¼ è³‡æ–™å¾©åŸï¼ˆåˆ†åˆ¥ä¸Šå‚³ï¼‰                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸ—„ï¸ è³‡æ–™åº«: [ é¸æ“‡æª”æ¡ˆ ] [ğŸ”„ å¾©åŸ]                   â”‚   â”‚
â”‚  â”‚  ğŸ“ ä¸Šå‚³æª”æ¡ˆ: [ é¸æ“‡æª”æ¡ˆ ] [ğŸ”„ å¾©åŸ]                 â”‚   â”‚
â”‚  â”‚  ğŸ“„ ISO æ–‡ä»¶: [ é¸æ“‡æª”æ¡ˆ ] [ğŸ”„ å¾©åŸ]                 â”‚   â”‚
â”‚  â”‚                                                    â”‚   â”‚
â”‚  â”‚  âš ï¸ è­¦å‘Šï¼šå¾©åŸè³‡æ–™åº«å¾Œå°‡å¼·åˆ¶ç™»å‡ºæ‰€æœ‰ä½¿ç”¨è€…ï¼           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.2.2 å…ƒä»¶æª”æ¡ˆ

**æ–°å¢æª”æ¡ˆ**:

- `src/components/admin/BackupRestoreSection.tsx` - ä¸»è¦ UI å…ƒä»¶
- `src/actions/backup.ts` - Server Actions

---

### 3.3 è³‡æ–™åº«åŒ¯å‡ºç­–ç•¥

ç”±æ–¼ Next.js ç’°å¢ƒé™åˆ¶ï¼Œç„¡æ³•ç›´æ¥åŸ·è¡Œ `pg_dump` CLI å·¥å…·ï¼Œæ”¹ç”¨ä»¥ä¸‹ç­–ç•¥ï¼š

#### æ–¹æ¡ˆ A: Prisma è³‡æ–™åºåˆ—åŒ– (æ¨è–¦)

ä½¿ç”¨ Prisma Client è®€å–æ‰€æœ‰è³‡æ–™è¡¨ï¼Œè½‰æ›ç‚ºæ¨™æº– SQL INSERT èªå¥ï¼š

```typescript
async function exportDatabaseToSQL(): Promise<string> {
  const tables = [
    'User', 'Project', 'Item', 'ItemRelation', 'ItemReference',
    'ChangeRequest', 'ItemHistory', 'QCDocumentApproval', 'QCDocumentRevision',
    'DataFile', 'DataFileChangeRequest', 'DataFileHistory',
    'Notification', 'LoginLog'
  ];
  
  let sql = '-- RMS Database Backup\n';
  sql += `-- Generated at: ${new Date().toISOString()}\n\n`;
  
  for (const table of tables) {
    const records = await prisma[table].findMany();
    if (records.length > 0) {
      sql += generateInsertStatements(table, records);
    }
  }
  
  return sql;
}
```

#### æ–¹æ¡ˆ B: ç›´æ¥ PostgreSQL é€£æ¥ (é€²éš)

ä½¿ç”¨ `pg` å¥—ä»¶ç›´æ¥é€£æ¥è³‡æ–™åº«åŸ·è¡Œ SQL å‘½ä»¤ï¼š

```typescript
import { Pool } from 'pg';

async function exportWithPgDump(): Promise<string> {
  const pool = new Pool({ connectionString: process.env.DATABASE_URL });
  const client = await pool.connect();
  
  // ä½¿ç”¨ COPY å‘½ä»¤åŒ¯å‡ºè³‡æ–™
  // ...
}
```

---

### 3.4 æª”æ¡ˆçµæ§‹è®Šæ›´

```
src/
â”œâ”€â”€ app/
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ admin/
â”‚           â”œâ”€â”€ backup/
â”‚           â”‚   â””â”€â”€ route.ts          [NEW]
â”‚           â””â”€â”€ restore/
â”‚               â””â”€â”€ route.ts          [NEW]
â”œâ”€â”€ actions/
â”‚   â””â”€â”€ backup.ts                     [NEW]
â”œâ”€â”€ components/
â”‚   â””â”€â”€ admin/
â”‚       â””â”€â”€ BackupRestoreSection.tsx  [NEW]
â””â”€â”€ lib/
    â””â”€â”€ backup-utils.ts               [NEW]
```

---

## 4. å®‰å…¨æ€§è€ƒé‡

### 4.1 æ¬Šé™æ§ç®¡

- æ‰€æœ‰å‚™ä»½/å¾©åŸæ“ä½œåƒ…é™ ADMIN è§’è‰²
- æ“ä½œè¨˜éŒ„å¯«å…¥ `LoginLog` å¯©è¨ˆæ—¥èªŒ

### 4.2 è³‡æ–™ä¿è­·

- å‚™ä»½æª”æ¡ˆåŒ…å«æ•æ„Ÿè³‡è¨Šï¼ˆå¯†ç¢¼é›œæ¹Šã€ä½¿ç”¨è€…è³‡æ–™ï¼‰ï¼Œæé†’ä½¿ç”¨è€…å¦¥å–„ä¿ç®¡
- ~~å¯é¸ï¼šæ”¯æ´ ZIP å¯†ç¢¼åŠ å¯†~~ â†’ **ä¸åŠ å¯†**ï¼ˆä¾ä½¿ç”¨è€…éœ€æ±‚ç¢ºèªï¼‰

### 4.3 å¾©åŸå®‰å…¨æ©Ÿåˆ¶

- åŸ·è¡Œå¾©åŸå‰è‡ªå‹•å»ºç«‹ã€Œå¾©åŸå‰å‚™ä»½ã€
- å¾©åŸå¤±æ•—æ™‚å¯ Rollback
- éœ€è¼¸å…¥ç¢ºèªæ–‡å­—ï¼ˆå¦‚ "RESTORE"ï¼‰é˜²æ­¢èª¤è§¸
- **è³‡æ–™åº«å¾©åŸå®Œæˆå¾Œå¼·åˆ¶ç™»å‡ºæ‰€æœ‰ä½¿ç”¨è€…**ï¼ˆæ¸…é™¤æ‰€æœ‰ Sessionï¼‰

---

## 5. ä½¿ç”¨è€…é«”é©—

### 5.1 å‚™ä»½æµç¨‹

1. åœ¨ `/admin/users` é é¢åº•éƒ¨é»æ“Šã€Œè³‡æ–™å‚™ä»½ã€å€å¡Š
2. é¸æ“‡è¦å‚™ä»½çš„é¡åˆ¥ï¼ˆè³‡æ–™åº« / ä¸Šå‚³æª”æ¡ˆ / ISO æ–‡ä»¶ï¼‰
3. é»æ“Šå°æ‡‰çš„ã€Œä¸‹è¼‰ã€æŒ‰éˆ•
4. ç­‰å¾…é€²åº¦æ¢å®Œæˆï¼ˆé¡¯ç¤ºç›®å‰è™•ç†éšæ®µï¼‰
5. ç€è¦½å™¨è‡ªå‹•ä¸‹è¼‰å°æ‡‰çš„ ZIP æª”æ¡ˆ
6. é‡è¤‡æ­¥é©Ÿ 3-5 å®Œæˆæ‰€æœ‰é¡åˆ¥å‚™ä»½

### 5.2 å¾©åŸæµç¨‹

1. åœ¨ã€Œè³‡æ–™å¾©åŸã€å€å¡Šé¸æ“‡å°æ‡‰é¡åˆ¥çš„ ZIP æª”æ¡ˆ
2. ç³»çµ±é©—è­‰æª”æ¡ˆæ ¼å¼ä¸¦é¡¯ç¤ºå‚™ä»½è³‡è¨Š
3. é¡¯ç¤ºè­¦å‘Šç¢ºèªå°è©±æ¡†
4. è¼¸å…¥ "RESTORE" ç¢ºèª
5. é¡¯ç¤ºå¾©åŸé€²åº¦
6. **è‹¥ç‚ºè³‡æ–™åº«å¾©åŸï¼Œå®Œæˆå¾Œå¼·åˆ¶ç™»å‡ºï¼Œéœ€é‡æ–°ç™»å…¥**
7. å…¶ä»–é¡åˆ¥å¾©åŸå®Œæˆå¾Œè‡ªå‹•é‡æ–°æ•´ç†é é¢

---

## 6. æ¸¬è©¦è¨ˆç•«

### 6.1 åŠŸèƒ½æ¸¬è©¦

| æ¸¬è©¦é …ç›® | é æœŸçµæœ |
|----------|----------|
| Admin åŸ·è¡Œå‚™ä»½ | æˆåŠŸä¸‹è¼‰ ZIP æª”æ¡ˆ |
| Non-Admin åŸ·è¡Œå‚™ä»½ | é¡¯ç¤ºæ¬Šé™ä¸è¶³ |
| å‚™ä»½æª”æ¡ˆè§£å£“ | çµæ§‹æ­£ç¢ºï¼ŒåŒ…å« SQL èˆ‡æª”æ¡ˆ |
| ç©ºç³»çµ±å¾©åŸ | è³‡æ–™æ­£ç¢ºåŒ¯å…¥ |
| å·²æœ‰è³‡æ–™å¾©åŸ | è¦†è“‹ç¾æœ‰è³‡æ–™ |
| æå£å‚™ä»½é‚„åŸ | é¡¯ç¤ºéŒ¯èª¤ï¼Œä¸å½±éŸ¿ç¾æœ‰è³‡æ–™ |

### 6.2 æ•ˆèƒ½æ¸¬è©¦

| è³‡æ–™é‡ | é æœŸæ™‚é–“ |
|--------|----------|
| 100 é …ç›® + 50 æª”æ¡ˆ | < 30 ç§’ |
| 1000 é …ç›® + 200 æª”æ¡ˆ | < 2 åˆ†é˜ |
| 5000 é …ç›® + 500 æª”æ¡ˆ | < 5 åˆ†é˜ |

---

## 7. é‡Œç¨‹ç¢‘

| éšæ®µ | ä»»å‹™ | é ä¼°æ™‚é–“ |
|------|------|----------|
| Phase 1 | å‚™ä»½ API èˆ‡è³‡æ–™åº«åŒ¯å‡º | 2 å°æ™‚ |
| Phase 2 | å‚™ä»½ UI èˆ‡ä¸‹è¼‰åŠŸèƒ½ | 1 å°æ™‚ |
| Phase 3 | å¾©åŸ API èˆ‡è³‡æ–™åŒ¯å…¥ | 2 å°æ™‚ |
| Phase 4 | å¾©åŸ UI èˆ‡ä¸Šå‚³åŠŸèƒ½ | 1 å°æ™‚ |
| Phase 5 | å®‰å…¨æ©Ÿåˆ¶èˆ‡éŒ¯èª¤è™•ç† | 1 å°æ™‚ |
| Phase 6 | æ¸¬è©¦èˆ‡æ–‡ä»¶æ›´æ–° | 1 å°æ™‚ |

**ç¸½é ä¼°æ™‚é–“**: 8 å°æ™‚

---

## 8. ç›¸ä¾å¥—ä»¶

### éœ€è¦å®‰è£

```bash
npm install archiver @types/archiver
npm install adm-zip @types/adm-zip
```

### å·²æœ‰å¥—ä»¶ (ç„¡éœ€å®‰è£)

- `prisma` - è³‡æ–™åº«æ“ä½œ
- `next-auth` - æ¬Šé™é©—è­‰
- `fs` / `path` - æª”æ¡ˆç³»çµ±

---

## 9. åƒè€ƒè³‡æº

- ç¾æœ‰å‚™ä»½è…³æœ¬: `scripts/backup.ps1` (PowerShell, Docker ç’°å¢ƒ)
- ç¾æœ‰å¾©åŸè…³æœ¬: `scripts/restore.ps1` (PowerShell, Docker ç’°å¢ƒ)
- éƒ¨ç½²æ–‡ä»¶: `docs/deployment_steps.md`

---

## 10. ç¢ºèªäº‹é …ï¼ˆå·²ç¢ºèª âœ…ï¼‰

| é …ç›® | æ±ºè­° |
|------|------|
| æœ€å¤§å‚™ä»½æª”æ¡ˆå¤§å°é™åˆ¶ | âœ… **ä¸é™åˆ¶**ï¼Œä¾ç³»çµ±è³‡æºè‡ªå‹•è™•ç† |
| æ˜¯å¦æ”¯æ´å¢é‡å‚™ä»½ | âœ… **ä¸éœ€è¦**ï¼Œåƒ…æ”¯æ´å®Œæ•´å‚™ä»½ |
| æ˜¯å¦éœ€è¦å‚™ä»½åŠ å¯† | âœ… **ä¸åŠ å¯†**ï¼Œç”±ä½¿ç”¨è€…è‡ªè¡Œç®¡ç†æª”æ¡ˆå®‰å…¨ |
| å¾©åŸå¾Œå¼·åˆ¶ç™»å‡º | âœ… **æ˜¯**ï¼Œè³‡æ–™åº«å¾©åŸå¾Œå¼·åˆ¶ç™»å‡ºæ‰€æœ‰ä½¿ç”¨è€… |
